/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.4/samples
 */
plugins {
    id 'java'
    id 'io.spring.dependency-management' version '1.0.8.RELEASE'
    id 'com.adarshr.test-logger' version '2.0.0'
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'io.spring.dependency-management'
    apply plugin: 'jacoco'
    apply plugin: 'com.adarshr.test-logger'

    sourceCompatibility = 11
    targetCompatibility = 11

    ext {
        baseImage = 'adoptopenjdk:11-jdk'
    }

    group 'com.market-stock'
    version 'unspecified'

    tasks.withType(JavaCompile) {
        options.encoding = 'UTF-8'
    }

    repositories {
        mavenCentral()
    }

    dependencies {
        compileOnly 'org.projectlombok:lombok:1.18.22'
        annotationProcessor 'org.projectlombok:lombok:1.18.22'
        testCompileOnly 'org.projectlombok:lombok:1.18.22'
        testAnnotationProcessor 'org.projectlombok:lombok:1.18.22'
        testImplementation 'org.assertj:assertj-core:3.15.0'
    }

    test {
        useJUnitPlatform()

        testLogging {
            exceptionFormat = 'full'
            events 'passed', 'skipped', 'failed'
        }
    }

    tasks.named("test") {
        systemProperties = [
                "junit.jupiter.execution.parallel.enabled": true
        ]
    }

    tasks.register("integration", Test) {
        useJUnitPlatform {
            includeTags "integration"
        }
    }

    tasks.register("unit", Test) {
        systemProperties = [
                "junit.jupiter.execution.parallel.enabled": true
        ]

        useJUnitPlatform {
            excludeTags "integration"
        }
    }

    testlogger {
        theme 'mocha-parallel'
        slowThreshold 2000
        showSimpleNames true
        showStandardStreams false
    }
}